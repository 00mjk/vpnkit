machine:
  xcode:
    version: "9.0"
  environment:
    OPAMYES: "1"
    OPAMJOBS: "2"
    MACOSX_DEPLOYMENT_TARGET: "10.10"
    CUSTOM_OPAM: "1"
    OPAM_REPO: repo/darwin
    OPAM_COMP: "4.06.0"
    OPAMVERBOSE: 1
general:
  artifacts:
  - vpnkit.tgz
  - COMMIT
  - OSS-LICENSES
dependencies:
  override:
  - brew unlink python # remove files in /usr/local/bin
  - brew install wget opam dylibbundler pkg-config
  - make
  - make artefacts
  cache_directories:
    - _build/opam
test:
  override:
  - make test
